---
layout: post
title:  "SpringBoot 서버 구축"
date:   2021-09-22 14:43:00 +0900
categories: Server
tags: Springboot Server Linux AWS
---

javalia.dev의 스프링 부트 서버를 구축하는 과정을 정리한 기록

### 서버 요구사항
1. https 지원(.dev도메인의 주소는 웹브라우저로 열 경우 https사용이 강제된다.)
2. http 동시 지원(사용하는 Let`s Encrypt는 인증 시에 http 통신을 요구한다.)
3. 스프링 부트를 사용할 것(한 가지만 배워야 한다면 가장 어려운 것을 배운다. 라틴어를 배우면 유럽의 언어들이 쉬워질 것이라는 생각이다.)
4. 8080에서 http, 8443에서 https, 8081에서 관리를 위한 actuator 서비스를 노출한다.

### 도메인 구입 & 설정
javalia.dev를 godaddy.com에서 구입했다. 해당 도메인은 .io계열에 비해서 가격이 저렴했다.

### AWS 에 EC2인스턴스 구축
처음에는 맨 위에 뜨는 옵션인 Amazon Linux 2를 사용했으나, certbot 설치 과정에서 의존성 패키지 버전이 맞지 않았다. 업그레이드를 시도했으나 잘 되지 않아서 기존에 되는 것을 확인한 Ubuntu로 교체했다.

### AWS Elastic IP 설정
고정된 외부 아이피를 할당받아서 해당 아이피를 EC2 인스턴스에 연결한다.

### AWS 보안 그룹 설정
EC2 인스턴스의 보안 그룹 설정에서 80, 443, 22 포트를 열어준다. 각각 HTTP, HTTPS, SSH이다.

### AWS Route53 설정
godaddy.com과 Route53의 설정을 통해서 javalia.dev를 앞서 할당받은 고정아이피에 연결한다. 이로써 putty에서도 아이피가 아닌 javalia.dev로 접근할 수 있다. 물론 해당 방식으로 접근하기 위해서는 보안이 필요하고, ssh접근을 위한 비밀키를 아마존에서 다운로드해서 사용해야 한다.
#### ToDo
DNS설정에서 GoDaddy에게는 아마존 네임서버로 가라고만 했고, 아마존 네임 서버가 비록 호스팅 영역에 대해서 고유해서 일반적인 경우 적법한 설정만으로는 다른 사람의 DNS Name Server 연결 설정을 가로챌 수는 없다. 그러나 이런 연결에 암호화 기반 인증이 없기에 악의적인 방식을 동원하면 DNS 요청에 대한 가로채기가 가능하다. 이것을 막기 위해서는 DNSSec을 적용해야 하는 것으로 보인다. 물론 실용성으로는 내 서버에 이것을 적용할 필요는 없지만 시간이 남는다면 해 보자.

### 스프링 부트 프로젝트 설정
VisualStudio Code의 익스텐션 기능 중 하나로 스프링 부트 프로젝트를 설정했다. 메이븐이 아닌 그레이들을 사용하도록 설정했다.
